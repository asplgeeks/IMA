{"ast":null,"code":"import _slicedToArray from\"D:/nodejs/IMA/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useContext,Fragment,useEffect}from'react';import classnames from'classnames';import Avatar from'@components/avatar';import{useSkin}from'@hooks/useSkin';import useJwt from'@src/auth/jwt/useJwt';import{useDispatch}from'react-redux';import{useForm}from'react-hook-form';import{toast,Slide}from'react-toastify';import{handleLogin}from'@store/actions/auth';import{AbilityContext}from'@src/utility/context/Can';import{Link,useHistory}from'react-router-dom';import InputPasswordToggle from'@components/input-password-toggle';import{getHomeRouteForLoggedInUser,isObjEmpty}from'@utils';import{Facebook,Twitter,Mail,GitHub,HelpCircle,Coffee}from'react-feather';import{Alert,Row,Col,CardTitle,CardText,Form,Input,FormGroup,Label,CustomInput,Button,UncontrolledTooltip}from'reactstrap';import axios from'axios';import'@styles/base/pages/page-auth.scss';import'react-toastify/dist/ReactToastify.css';import app from'../../../base';import{getAuth,signInWithCustomToken}from\"firebase/auth\";// import { AuthContext } from '../../../Auth'\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var loginAuthID=localStorage.getItem('loginId');var ToastContent=function ToastContent(_ref){var name=_ref.name,role=_ref.role;return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"toastify-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"title-wrapper\",children:[/*#__PURE__*/_jsx(Avatar,{size:\"sm\",color:\"warning\",icon:/*#__PURE__*/_jsx(Coffee,{size:12})}),/*#__PURE__*/_jsxs(\"h6\",{className:\"toast-title font-weight-bold\",style:{color:\"#ffffff\"},children:[\" \",name]})]})})});};var Login=function Login(props){var _useSkin=useSkin(),_useSkin2=_slicedToArray(_useSkin,2),skin=_useSkin2[0],setSkin=_useSkin2[1];var ability=useContext(AbilityContext);var dispatch=useDispatch();var history=useHistory();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),phone=_useState2[0],setPhone=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),mobileexist=_useState6[0],setExistMobile=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),logindata=_useState8[0],setLoginData=_useState8[1];var _useForm=useForm(),register=_useForm.register,errors=_useForm.errors,handleSubmit=_useForm.handleSubmit;var illustration=skin==='dark'?'login-v2-dark.svg':'login-v2.svg',source=require(\"@src/assets/images/pages/\".concat(illustration)).default;console.log(phone);console.log(mobileexist);if(mobileexist&&mobileexist.data&&mobileexist.data.data&&mobileexist.data.data.password===null){var sendotp='http://172.105.49.15:3030/api/user/send_otp';axios.post(sendotp,{mobile_number:phone.toString()}).then(function(r){console.log(r);toast(/*#__PURE__*/_jsx(ToastContent,{name:r.data.message,role:''}),{transition:Slide,hideProgressBar:true,autoClose:2000});props.history.push({pathname:'/login-otp',state:{id:mobileexist.data.data._id,mobile:phone}});// setExistMobile(r)\n});}var handlePhone=function handlePhone(e){setPhone(e.target.value);e.preventDefault();};var checkmobiurl='http://172.105.49.15:3030/api/user/check_mobile_number_exist';useEffect(function(){axios.post(checkmobiurl,{mobile_number:phone.toString()}).then(function(r){console.log(r);setExistMobile(r);});},[phone]);// localStorage.setItem('loginId', mobileexist && mobileexist.data && mobileexist.data._id)\nvar authIdToken=\"\";var onSubmit=function onSubmit(data){setLoginData(data);if(mobileexist&&mobileexist.data&&mobileexist.data.data&&mobileexist.data.data.password!==null){dispatch(handleLogin(data,props));}data={role:\"admin\"};history.push(getHomeRouteForLoggedInUser(data.role));// dispatch(handleLogin(data, props))\n// if (isObjEmpty(errors)) {\n//   useJwt\n//     .login({ phone, password })\n//     .then(res => {\n//       const data = { ...res.data.userData, accessToken: res.data.accessToken, refreshToken: res.data.refreshToken }\n//       // dispatch(handleLogin(data))\n//       ability.update(res.data.userData.ability)\n//       // toast.success(\n//       //   <ToastContent name={data.fullName || data.username || 'John Doe'} role={data.role || 'admin'} />,\n//       //   { transition: Slide, hideProgressBar: true, autoClose: 2000 }\n//       // )\n//     })\n//     .catch(err => {\n//       console.log(err.message)\n//       toast.error(\n//         <ToastContent name={\"Incorrect user number or password\"} role={''} />,\n//           { transition: Slide, hideProgressBar: true, autoClose: 2000 }\n//       )\n//     })\n// }\n};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-wrapper auth-v2\",children:/*#__PURE__*/_jsxs(Row,{className:\"auth-inner m-0\",children:[/*#__PURE__*/_jsx(Link,{className:\"brand-logo\",to:\"/\",onClick:function onClick(e){return e.preventDefault();}}),/*#__PURE__*/_jsx(Col,{className:\"d-none d-lg-flex align-items-center p-5\",lg:\"8\",sm:\"12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-100 d-lg-flex align-items-center justify-content-center px-5\",children:/*#__PURE__*/_jsx(\"img\",{className:\"img-fluid\",src:source,alt:\"Login V2\"})})}),/*#__PURE__*/_jsx(Col,{className:\"d-flex align-items-center auth-bg px-2 p-lg-5\",lg:\"4\",sm:\"12\",children:/*#__PURE__*/_jsxs(Col,{className:\"px-xl-2 mx-auto\",sm:\"8\",md:\"6\",lg:\"12\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{textShadow:\"2px 1px\",color:\"rgb(230,46,45)\",fontSize:\"35px\",fontWeight:300},children:\" Star Engineers\"}),/*#__PURE__*/_jsx(CardText,{className:\"mb-2\",children:\"Please sign-in to your account and start the adventure\"}),/*#__PURE__*/_jsxs(Form,{className:\"auth-login-form mt-2\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{className:\"form-label\",for:\"login-phone\",children:\"Mobile Number\"}),/*#__PURE__*/_jsx(Input,{autoFocus:true,type:\"text\",value:phone,id:\"login_phone\",name:\"login_phone\",placeholder:\"Enter Mobile Number\",maxLength:\"10\",onChange:function onChange(e){return handlePhone(e);}// className={classnames({ 'is-invalid': errors['login_phone'] })}\n,innerRef:register({required:true,pattern:{value:/[1-9]{1}[0-9]{9}/,message:\"please enter your 10 digit mobile number\"}})}),errors.login_phone&&errors.login_phone.type==='required'&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:\"Mobile Number is require\"})]}),mobileexist&&mobileexist.data&&mobileexist.data.data&&mobileexist.data.data.password!==null?/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-between\",children:/*#__PURE__*/_jsx(Label,{className:\"form-label\",for:\"login-password\",children:\"Password\"})}),/*#__PURE__*/_jsx(InputPasswordToggle,{value:password,id:\"login_password\",name:\"login_password\",className:\"input-group-merge\",onChange:function onChange(e){return setPassword(e.target.value);}// className={classnames({ 'is-invalid': errors['login_password'] })}\n,innerRef:register({required:true,message:\"please enter your valid password\"})}),errors.login_password&&/*#__PURE__*/_jsx(\"p\",{style:{color:\"red\"},children:errors.login_password.message})]}):\" \",/*#__PURE__*/_jsx(Button.Ripple,{type:\"submit\",color:\"primary\",block:true,children:\"Sign in\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-right mt-2\",children:/*#__PURE__*/_jsx(Link,{to:\"/forgot-password\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Forgot Password ?\"})})})]})})]})});};export default Login;","map":{"version":3,"sources":["D:/nodejs/IMA/src/views/pages/authentication/Login.js"],"names":["useState","useContext","Fragment","useEffect","classnames","Avatar","useSkin","useJwt","useDispatch","useForm","toast","Slide","handleLogin","AbilityContext","Link","useHistory","InputPasswordToggle","getHomeRouteForLoggedInUser","isObjEmpty","Facebook","Twitter","Mail","GitHub","HelpCircle","Coffee","Alert","Row","Col","CardTitle","CardText","Form","Input","FormGroup","Label","CustomInput","Button","UncontrolledTooltip","axios","app","getAuth","signInWithCustomToken","loginAuthID","localStorage","getItem","ToastContent","name","role","color","Login","props","skin","setSkin","ability","dispatch","history","phone","setPhone","password","setPassword","mobileexist","setExistMobile","logindata","setLoginData","register","errors","handleSubmit","illustration","source","require","default","console","log","data","sendotp","post","mobile_number","toString","then","r","message","transition","hideProgressBar","autoClose","push","pathname","state","id","_id","mobile","handlePhone","e","target","value","preventDefault","checkmobiurl","authIdToken","onSubmit","textShadow","fontSize","fontWeight","required","pattern","login_phone","type","login_password"],"mappings":"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","sourcesContent":["import { useState, useContext, Fragment, useEffect } from 'react'\r\nimport classnames from 'classnames'\r\nimport Avatar from '@components/avatar'\r\nimport { useSkin } from '@hooks/useSkin'\r\nimport useJwt from '@src/auth/jwt/useJwt'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useForm } from 'react-hook-form'\r\nimport { toast, Slide } from 'react-toastify'\r\nimport { handleLogin } from '@store/actions/auth'\r\nimport { AbilityContext } from '@src/utility/context/Can'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport InputPasswordToggle from '@components/input-password-toggle'\r\nimport { getHomeRouteForLoggedInUser, isObjEmpty } from '@utils'\r\nimport { Facebook, Twitter, Mail, GitHub, HelpCircle, Coffee } from 'react-feather'\r\nimport {\r\n  Alert,\r\n  Row,\r\n  Col,\r\n  CardTitle,\r\n  CardText,\r\n  Form,\r\n  Input,\r\n  FormGroup,\r\n  Label,\r\n  CustomInput,\r\n  Button,\r\n  UncontrolledTooltip\r\n} from 'reactstrap'\r\nimport axios from 'axios'\r\nimport '@styles/base/pages/page-auth.scss'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\nimport app from '../../../base'\r\nimport { getAuth, signInWithCustomToken } from \"firebase/auth\"\r\n// import { AuthContext } from '../../../Auth'\r\nconst loginAuthID = localStorage.getItem('loginId')\r\n\r\nconst ToastContent = ({ name, role }) => (\r\n  <Fragment>\r\n    <div className='toastify-header'>\r\n      <div className='title-wrapper'>\r\n        <Avatar size='sm' color='warning' icon={<Coffee size={12} />} />\r\n        <h6 className='toast-title font-weight-bold' style={{color:\"#ffffff\"}}> {name}</h6>\r\n      </div>\r\n    </div>\r\n    {/* <div className='toastify-body'>\r\n      <span>You have successfully logged in as an {role}. Now you can start to explore. Enjoy!</span>\r\n    </div> */}\r\n  </Fragment>\r\n)\r\n\r\nconst Login = props => {\r\n  const [skin, setSkin] = useSkin()\r\n  const ability = useContext(AbilityContext)\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const [phone, setPhone] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [mobileexist, setExistMobile] = useState()\r\nconst [logindata, setLoginData] = useState()\r\n  const { register, errors, handleSubmit } = useForm()\r\n  const illustration = skin === 'dark' ? 'login-v2-dark.svg' : 'login-v2.svg',\r\n    source = require(`@src/assets/images/pages/${illustration}`).default\r\n\r\nconsole.log(phone)\r\nconsole.log(mobileexist)\r\n\r\nif (mobileexist && mobileexist.data && mobileexist.data.data && mobileexist.data.data.password === null) {\r\n  const sendotp = 'http://172.105.49.15:3030/api/user/send_otp'\r\n  axios.post(sendotp, {\r\n    mobile_number: phone.toString()\r\n  })\r\n  .then(r => {\r\n    console.log(r)\r\n    toast(\r\n      <ToastContent name={r.data.message} role={''} />,\r\n        { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n    )\r\n    props.history.push({pathname:'/login-otp',\r\n  state:{\r\n    id : mobileexist.data.data._id,\r\n    mobile : phone\r\n  }\r\n})\r\n    // setExistMobile(r)\r\n  })\r\n } \r\nconst handlePhone = (e) => {\r\n  setPhone(e.target.value)\r\n  e.preventDefault()\r\n}\r\n\r\n  const checkmobiurl = 'http://172.105.49.15:3030/api/user/check_mobile_number_exist'\r\n  useEffect(() => {\r\n    axios.post(checkmobiurl, {\r\n      mobile_number: phone.toString()\r\n    })\r\n    .then(r => {\r\n      console.log(r)\r\n      setExistMobile(r)\r\n    })\r\n  }, [phone])\r\n\r\n    // localStorage.setItem('loginId', mobileexist && mobileexist.data && mobileexist.data._id)\r\n\r\nconst authIdToken = \"\"\r\n  const onSubmit = (data) => {\r\n    setLoginData(data)\r\n    if (mobileexist && mobileexist.data && mobileexist.data.data && mobileexist.data.data.password !== null) {\r\n    dispatch(handleLogin(data, props))\r\n    }\r\n    data = {role : \"admin\"}\r\n    history.push(getHomeRouteForLoggedInUser(data.role))\r\n    // dispatch(handleLogin(data, props))\r\n    // if (isObjEmpty(errors)) {\r\n    //   useJwt\r\n    //     .login({ phone, password })\r\n    //     .then(res => {\r\n    //       const data = { ...res.data.userData, accessToken: res.data.accessToken, refreshToken: res.data.refreshToken }\r\n    //       // dispatch(handleLogin(data))\r\n    //       ability.update(res.data.userData.ability)\r\n    //       // toast.success(\r\n    //       //   <ToastContent name={data.fullName || data.username || 'John Doe'} role={data.role || 'admin'} />,\r\n    //       //   { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n    //       // )\r\n    //     })\r\n    //     .catch(err => {\r\n    //       console.log(err.message)\r\n    //       toast.error(\r\n    //         <ToastContent name={\"Incorrect user number or password\"} role={''} />,\r\n    //           { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n    //       )\r\n    //     })\r\n    // }\r\n  }\r\n\r\n  return (\r\n    <div className='auth-wrapper auth-v2'>\r\n      <Row className='auth-inner m-0'>\r\n        <Link className='brand-logo' to='/' onClick={e => e.preventDefault()}>\r\n          {/* <svg viewBox='0 0 139 95' version='1.1' height='28'>\r\n            <defs>\r\n              <linearGradient x1='100%' y1='10.5120544%' x2='50%' y2='89.4879456%' id='linearGradient-1'>\r\n                <stop stopColor='#000000' offset='0%'></stop>\r\n                <stop stopColor='#FFFFFF' offset='100%'></stop>\r\n              </linearGradient>\r\n              <linearGradient x1='64.0437835%' y1='46.3276743%' x2='37.373316%' y2='100%' id='linearGradient-2'>\r\n                <stop stopColor='#EEEEEE' stopOpacity='0' offset='0%'></stop>\r\n                <stop stopColor='#FFFFFF' offset='100%'></stop>\r\n              </linearGradient>\r\n            </defs>\r\n            <g id='Page-1' stroke='none' strokeWidth='1' fill='none' fillRule='evenodd'>\r\n              <g id='Artboard' transform='translate(-400.000000, -178.000000)'>\r\n                <g id='Group' transform='translate(400.000000, 178.000000)'>\r\n                  <path\r\n                    d='M-5.68434189e-14,2.84217094e-14 L39.1816085,2.84217094e-14 L69.3453773,32.2519224 L101.428699,2.84217094e-14 L138.784583,2.84217094e-14 L138.784199,29.8015838 C137.958931,37.3510206 135.784352,42.5567762 132.260463,45.4188507 C128.736573,48.2809251 112.33867,64.5239941 83.0667527,94.1480575 L56.2750821,94.1480575 L6.71554594,44.4188507 C2.46876683,39.9813776 0.345377275,35.1089553 0.345377275,29.8015838 C0.345377275,24.4942122 0.230251516,14.560351 -5.68434189e-14,2.84217094e-14 Z'\r\n                    id='Path'\r\n                    className='text-primary'\r\n                    style={{ fill: 'currentColor' }}\r\n                  ></path>\r\n                  <path\r\n                    d='M69.3453773,32.2519224 L101.428699,1.42108547e-14 L138.784583,1.42108547e-14 L138.784199,29.8015838 C137.958931,37.3510206 135.784352,42.5567762 132.260463,45.4188507 C128.736573,48.2809251 112.33867,64.5239941 83.0667527,94.1480575 L56.2750821,94.1480575 L32.8435758,70.5039241 L69.3453773,32.2519224 Z'\r\n                    id='Path'\r\n                    fill='url(#linearGradient-1)'\r\n                    opacity='0.2'\r\n                  ></path>\r\n                  <polygon\r\n                    id='Path-2'\r\n                    fill='#000000'\r\n                    opacity='0.049999997'\r\n                    points='69.3922914 32.4202615 32.8435758 70.5039241 54.0490008 16.1851325'\r\n                  ></polygon>\r\n                  <polygon\r\n                    id='Path-2'\r\n                    fill='#000000'\r\n                    opacity='0.099999994'\r\n                    points='69.3922914 32.4202615 32.8435758 70.5039241 58.3683556 20.7402338'\r\n                  ></polygon>\r\n                  <polygon\r\n                    id='Path-3'\r\n                    fill='url(#linearGradient-2)'\r\n                    opacity='0.099999994'\r\n                    points='101.428699 0 83.0667527 94.1480575 130.378721 47.0740288'\r\n                  ></polygon>\r\n                </g>\r\n              </g>\r\n            </g>\r\n          </svg>\r\n          <h2 className='brand-text text-primary ml-1'>Vuexy</h2> */}\r\n        </Link>\r\n        <Col className='d-none d-lg-flex align-items-center p-5' lg='8' sm='12'>\r\n          <div className='w-100 d-lg-flex align-items-center justify-content-center px-5'>\r\n            <img className='img-fluid' src={source} alt='Login V2' />\r\n          </div>\r\n        </Col>\r\n        <Col className='d-flex align-items-center auth-bg px-2 p-lg-5' lg='4' sm='12'>\r\n          <Col className='px-xl-2 mx-auto' sm='8' md='6' lg='12'>\r\n            {/* <CardTitle tag='h2' className='font-weight-bold mb-1'>\r\n              Welcome to Vuexy! ðŸ‘‹\r\n            </CardTitle> */}\r\n            <h1 style={{textShadow:\"2px 1px\", color:\"rgb(230,46,45)\", fontSize:\"35px\", fontWeight:300}}> Star Engineers</h1>\r\n            <CardText className='mb-2'>Please sign-in to your account and start the adventure</CardText>\r\n            {/* <Alert color='primary'>\r\n              <div className='alert-body font-small-2'>\r\n                <p>\r\n                  <small className='mr-50'>\r\n                    <span className='font-weight-bold'>Admin:</span> admin@demo.com | admin\r\n                  </small>\r\n                </p>\r\n                <p>\r\n                  <small className='mr-50'>\r\n                    <span className='font-weight-bold'>Client:</span> client@demo.com | client\r\n                  </small>\r\n                </p>\r\n              </div>\r\n              <HelpCircle\r\n                id='login-tip'\r\n                className='position-absolute'\r\n                size={18}\r\n                style={{ top: '10px', right: '10px' }}\r\n              />\r\n              <UncontrolledTooltip target='login-tip' placement='left'>\r\n                This is just for ACL demo purpose.\r\n              </UncontrolledTooltip>\r\n            </Alert> */}\r\n            <Form className='auth-login-form mt-2' onSubmit={handleSubmit(onSubmit)}>\r\n              <FormGroup>\r\n                <Label className='form-label' for='login-phone'>\r\n                Mobile Number\r\n                </Label>\r\n                <Input\r\n                  autoFocus\r\n                  type='text'\r\n                  value={phone}\r\n                  id='login_phone'\r\n                  name='login_phone'\r\n                  placeholder='Enter Mobile Number'\r\n                  maxLength=\"10\"\r\n                  onChange={e => handlePhone(e)}\r\n                  // className={classnames({ 'is-invalid': errors['login_phone'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                    pattern:{value:/[1-9]{1}[0-9]{9}/,\r\n                    message:\"please enter your 10 digit mobile number\"}\r\n                 })}\r\n                />\r\n                 {/* {errors.login_phone && <p style={{color:\"red\"}}>{errors.login_phone.message}</p>} */}\r\n                 {errors.login_phone && errors.login_phone.type === 'required' && <p style={{color:\"red\"}}>Mobile Number is require</p>}\r\n                 {/* {  phone ? mobileexist && mobileexist.data && mobileexist.data.data === null ? <p style={{color:\"red\"}}>Mobile Number Not Exist</p> : \"\" : \"\"} */}\r\n              </FormGroup> \r\n\r\n              { mobileexist && mobileexist.data && mobileexist.data.data && mobileexist.data.data.password !== null ? <FormGroup>\r\n                <div className='d-flex justify-content-between'>\r\n                  <Label className='form-label' for='login-password'>\r\n                    Password\r\n                  </Label>\r\n                  {/* <Link to='/forgot-password'>\r\n                    <small>Forgot Password?</small>\r\n                  </Link> */}\r\n                </div>\r\n                <InputPasswordToggle\r\n                  value={password}\r\n                  id='login_password'\r\n                  name='login_password'\r\n                  className='input-group-merge'\r\n                  onChange={e => setPassword(e.target.value)}\r\n                  // className={classnames({ 'is-invalid': errors['login_password'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                    message:\"please enter your valid password\"\r\n                  })}\r\n                />\r\n                  {errors.login_password && <p style={{color:\"red\"}}>{errors.login_password.message}</p>}\r\n              </FormGroup> : \" \"\r\n              }\r\n              {/* <FormGroup>\r\n                <CustomInput type='checkbox' className='custom-control-Primary' id='remember-me' label='Remember Me' />\r\n              </FormGroup> */}\r\n              <Button.Ripple type='submit' color='primary' block>\r\n                Sign in\r\n              </Button.Ripple>\r\n            </Form>\r\n            <p className='text-right mt-2'>\r\n              {/* <span className='mr-25'>New on our platform?</span> */}\r\n              {/* <Link to='/register'> */}\r\n              <Link to='/forgot-password'>\r\n                <span>Forgot Password ?</span>\r\n              </Link>\r\n            </p>\r\n            {/* <div className='divider my-2'>\r\n              <div className='divider-text'>or</div>\r\n            </div>\r\n            <div className='auth-footer-btn d-flex justify-content-center'>\r\n              <Button.Ripple color='facebook'>\r\n                <Facebook size={14} />\r\n              </Button.Ripple>\r\n              <Button.Ripple color='twitter'>\r\n                <Twitter size={14} />\r\n              </Button.Ripple>\r\n              <Button.Ripple color='google'>\r\n                <Mail size={14} />\r\n              </Button.Ripple>\r\n              <Button.Ripple className='mr-0' color='github'>\r\n                <GitHub size={14} />\r\n              </Button.Ripple>\r\n            </div> */}\r\n          </Col>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Login\r\n"]},"metadata":{},"sourceType":"module"}