{"ast":null,"code":"import _defineProperty from \"D:/nodejs/star/erpfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"D:/nodejs/star/erpfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"D:\\\\nodejs\\\\star\\\\erpfrontend\\\\src\\\\views\\\\pages\\\\authentication\\\\OtpOnLogin.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useState, useContext, Fragment, useEffect } from 'react';\nimport classnames from 'classnames';\nimport Avatar from '@components/avatar';\nimport { useSkin } from '@hooks/useSkin';\nimport useJwt from '@src/auth/jwt/useJwt';\nimport { useDispatch } from 'react-redux';\nimport { useForm } from 'react-hook-form';\nimport { toast, Slide } from 'react-toastify';\nimport { SendOtp } from '@store/actions/auth';\nimport { AbilityContext } from '@src/utility/context/Can';\nimport { Link, useHistory } from 'react-router-dom';\nimport InputPasswordToggle from '@components/input-password-toggle';\nimport { withRouter } from 'react-router';\nimport { getHomeRouteForLoggedInUser, isObjEmpty } from '@utils';\nimport { Facebook, Twitter, Mail, GitHub, HelpCircle, Coffee } from 'react-feather';\nimport OtpInput from \"react-otp-input\";\nimport { Alert, Row, Col, CardTitle, CardText, Form, Input, FormGroup, Label, CustomInput, Button, UncontrolledTooltip } from 'reactstrap';\nimport axios from 'axios';\nimport '@styles/base/pages/page-auth.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar ToastContent = function ToastContent(_ref) {\n  var name = _ref.name,\n      role = _ref.role;\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"toastify-header\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          size: \"sm\",\n          color: \"success\",\n          icon: /*#__PURE__*/_jsxDEV(Coffee, {\n            size: 12\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 38,\n            columnNumber: 49\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 9\n        }, _this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"toast-title font-weight-bold\",\n          children: [\"Welcome, \", name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 39,\n          columnNumber: 9\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 7\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 3\n  }, _this);\n};\n\n_c = ToastContent;\n\nvar OtpOnLogin = function OtpOnLogin(props) {\n  _s();\n\n  var _jsxDEV2;\n\n  var _useSkin = useSkin(),\n      _useSkin2 = _slicedToArray(_useSkin, 2),\n      skin = _useSkin2[0],\n      setSkin = _useSkin2[1];\n\n  var ability = useContext(AbilityContext);\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var _useState = useState(props && props.location && props.location.state && props.location.state.login_phone),\n      _useState2 = _slicedToArray(_useState, 2),\n      phone = _useState2[0],\n      setPhone = _useState2[1];\n\n  var _useState3 = useState(50),\n      _useState4 = _slicedToArray(_useState3, 2),\n      count = _useState4[0],\n      setCount = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      otp = _useState6[0],\n      setOtp = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      existmobile = _useState8[0],\n      setExistMobile = _useState8[1];\n\n  console.log(props);\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      errors = _useForm.errors,\n      handleSubmit = _useForm.handleSubmit;\n\n  var illustration = skin === 'dark' ? 'login-v2-dark.svg' : 'login-v2.svg',\n      source = require(\"@src/assets/images/pages/\".concat(illustration)).default;\n\n  var intervalId; // console.log(props)\n  // console.log(props.location.state.login_phone)\n\n  var resend = function resend() {\n    clearInterval(intervalId);\n    setCount(50); // history.push('/otp')\n\n    axios.post(\"http://172.105.49.15:3030/api/user/send_otp\", {\n      mobile_number: props.location.state.mobile // password:data.password\n\n    }).then(function (r) {\n      console.log(r); // setExistMobile(r)\n    });\n  }; // useEffect(() => {\n  // axios.post(`http://172.105.49.15:3030/api/user/check_mobile_number_exist`, {\n  //     mobile_number:phone\n  //     // password:data.password\n  // })\n  // .then(r => { \n  //   console.log(r)\n  //   setExistMobile(r)\n  //    if (r.data !== null) {\n  //     axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\n  //       mobile_number:phone\n  //       // password:data.password\n  //   })\n  //   .then(r => {\n  //     console.log(r)\n  //   })\n  // //   props.history.push('/otp')\n  //   toast.success(\n  //     <ToastContent name={ 'We will send you a OTP to verify user'} role={ 'admin'} />,\n  //     { transition: Slide, hideProgressBar: true, autoClose: 2000 }\n  //   )\n  //   } else {\n  //     // alert(\"Mobile number not exist\")\n  //   }\n  //   })\n  // }, [phone])\n\n\n  useEffect(function () {\n    intervalId = setInterval(function () {\n      return setCount(function (counter) {\n        return counter - 1;\n      });\n    }, 1000);\n  }, [setCount]); // console.log(count, intervalId)\n\n  if (count === -1) {\n    // resend()\n    setCount(0);\n  }\n\n  var onSubmit = function onSubmit(data) {\n    console.log(data);\n    dispatch(SendOtp(data, props)); // history.push('/forgot-password')\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth-wrapper auth-v2\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"auth-inner m-0\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        className: \"d-none d-lg-flex align-items-center p-5\",\n        lg: \"8\",\n        sm: \"12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-100 d-lg-flex align-items-center justify-content-center px-5\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"img-fluid\",\n            src: source,\n            alt: \"Login V2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }, _this), /*#__PURE__*/_jsxDEV(Col, {\n        className: \"d-flex align-items-center auth-bg px-2 p-lg-5\",\n        lg: \"4\",\n        sm: \"12\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          className: \"px-xl-2 mx-auto\",\n          sm: \"8\",\n          md: \"6\",\n          lg: \"12\",\n          children: [/*#__PURE__*/_jsxDEV(CardText, {\n            className: \"mb-2\",\n            children: \"We will send you a OTP to verify user.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Form, {\n            className: \"auth-login-form mt-2\",\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between\",\n                children: /*#__PURE__*/_jsxDEV(Label, {\n                  className: \"form-label\",\n                  for: \"login-password\",\n                  children: \"OTP\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Input, (_jsxDEV2 = {\n                value: otp,\n                id: \"login_otp\",\n                name: \"login_otp\",\n                maxLength: 6,\n                className: \"input-group-merge\",\n                placeholder: \"Enter Your OTP\",\n                onChange: function onChange(e) {\n                  return setOtp(e.target.value);\n                }\n              }, _defineProperty(_jsxDEV2, \"className\", classnames({\n                'is-invalid': errors['login_otp']\n              })), _defineProperty(_jsxDEV2, \"innerRef\", register({\n                required: true,\n                pattern: {\n                  value: /^\\d{6}$/,\n                  message: \"please enter your 6 digit otp\"\n                },\n                validate: function validate(value) {\n                  return value !== '';\n                }\n              })), _jsxDEV2), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 161,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 17\n            }, _this), count === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \" Didn't receive the otp ?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 14\n              }, _this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                onClick: resend,\n                style: {\n                  color: \"red\"\n                },\n                children: \"Resend OTP\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 48\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 30\n            }, _this) : /*#__PURE__*/_jsxDEV(Button.Ripple, {\n              type: \"submit\",\n              color: \"primary\",\n              block: true,\n              children: \"Send OTP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 23\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"text-right mt-2\",\n            children: [\"00:\", count]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(OtpOnLogin, \"GL7J2FQWaPcmcG4fYBm+GEebxF8=\", false, function () {\n  return [useSkin, useDispatch, useHistory, useForm];\n});\n\n_c2 = OtpOnLogin;\nexport default _c3 = withRouter(OtpOnLogin);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ToastContent\");\n$RefreshReg$(_c2, \"OtpOnLogin\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["D:/nodejs/star/erpfrontend/src/views/pages/authentication/OtpOnLogin.js"],"names":["useState","useContext","Fragment","useEffect","classnames","Avatar","useSkin","useJwt","useDispatch","useForm","toast","Slide","SendOtp","AbilityContext","Link","useHistory","InputPasswordToggle","withRouter","getHomeRouteForLoggedInUser","isObjEmpty","Facebook","Twitter","Mail","GitHub","HelpCircle","Coffee","OtpInput","Alert","Row","Col","CardTitle","CardText","Form","Input","FormGroup","Label","CustomInput","Button","UncontrolledTooltip","axios","ToastContent","name","role","OtpOnLogin","props","skin","setSkin","ability","dispatch","history","location","state","login_phone","phone","setPhone","count","setCount","otp","setOtp","existmobile","setExistMobile","console","log","register","errors","handleSubmit","illustration","source","require","default","intervalId","resend","clearInterval","post","mobile_number","mobile","then","r","setInterval","counter","onSubmit","data","e","target","value","required","pattern","message","validate","display","color"],"mappings":"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","sourcesContent":["import { useState, useContext, Fragment, useEffect } from 'react'\r\nimport classnames from 'classnames'\r\nimport Avatar from '@components/avatar'\r\nimport { useSkin } from '@hooks/useSkin'\r\nimport useJwt from '@src/auth/jwt/useJwt'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useForm } from 'react-hook-form'\r\nimport { toast, Slide } from 'react-toastify'\r\nimport { SendOtp } from '@store/actions/auth'\r\nimport { AbilityContext } from '@src/utility/context/Can'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport InputPasswordToggle from '@components/input-password-toggle'\r\nimport { withRouter } from 'react-router'\r\nimport { getHomeRouteForLoggedInUser, isObjEmpty } from '@utils'\r\nimport { Facebook, Twitter, Mail, GitHub, HelpCircle, Coffee } from 'react-feather'\r\nimport OtpInput from \"react-otp-input\"\r\nimport {\r\n  Alert,\r\n  Row,\r\n  Col,\r\n  CardTitle,\r\n  CardText,\r\n  Form,\r\n  Input,\r\n  FormGroup,\r\n  Label,\r\n  CustomInput,\r\n  Button,\r\n  UncontrolledTooltip\r\n} from 'reactstrap'\r\nimport axios from 'axios'\r\nimport '@styles/base/pages/page-auth.scss'\r\n\r\nconst ToastContent = ({ name, role }) => (\r\n  <Fragment>\r\n    <div className='toastify-header'>\r\n      <div className='title-wrapper'>\r\n        <Avatar size='sm' color='success' icon={<Coffee size={12} />} />\r\n        <h6 className='toast-title font-weight-bold'>Welcome, {name}</h6>\r\n      </div>\r\n    </div>\r\n    {/* <div className='toastify-body'>\r\n      <span>You have successfully logged in as an {role}. Now you can start to explore. Enjoy!</span>\r\n    </div> */}\r\n  </Fragment>\r\n)\r\n\r\nconst OtpOnLogin = props => {\r\n  const [skin, setSkin] = useSkin()\r\n  const ability = useContext(AbilityContext)\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const [phone, setPhone] = useState(props && props.location && props.location.state && props.location.state.login_phone)\r\n  const [count, setCount] = useState(50)\r\n  const [otp, setOtp] = useState('')\r\n  const [existmobile, setExistMobile] = useState('')\r\nconsole.log(props)\r\n  const { register, errors, handleSubmit } = useForm()\r\n  const illustration = skin === 'dark' ? 'login-v2-dark.svg' : 'login-v2.svg',\r\n    source = require(`@src/assets/images/pages/${illustration}`).default\r\n    let intervalId\r\n// console.log(props)\r\n// console.log(props.location.state.login_phone)\r\n    const resend = () => {\r\n      clearInterval(intervalId)\r\n      setCount(50)\r\n    // history.push('/otp')\r\n    axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\r\n    mobile_number:props.location.state.mobile\r\n    // password:data.password\r\n})\r\n.then(r => { \r\n  console.log(r)\r\n  // setExistMobile(r)\r\n  })\r\n    }\r\n  \r\n// useEffect(() => {\r\n// axios.post(`http://172.105.49.15:3030/api/user/check_mobile_number_exist`, {\r\n//     mobile_number:phone\r\n//     // password:data.password\r\n// })\r\n// .then(r => { \r\n//   console.log(r)\r\n//   setExistMobile(r)\r\n//    if (r.data !== null) {\r\n//     axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\r\n//       mobile_number:phone\r\n//       // password:data.password\r\n//   })\r\n//   .then(r => {\r\n//     console.log(r)\r\n//   })\r\n// //   props.history.push('/otp')\r\n//   toast.success(\r\n//     <ToastContent name={ 'We will send you a OTP to verify user'} role={ 'admin'} />,\r\n//     { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n//   )\r\n\r\n//   } else {\r\n//     // alert(\"Mobile number not exist\")\r\n//   }\r\n//   })\r\n// }, [phone])\r\nuseEffect(() => {\r\n  intervalId = setInterval(() => setCount(counter => counter - 1), 1000)\r\n}, [setCount])\r\n// console.log(count, intervalId)\r\nif (count === -1) {\r\n  // resend()\r\n  setCount(0)\r\n}\r\n  const onSubmit = data => {\r\n    console.log(data)\r\n    dispatch(SendOtp(data, props))\r\n// history.push('/forgot-password')\r\n  }\r\n\r\n  return (\r\n    <div className='auth-wrapper auth-v2'>\r\n      <Row className='auth-inner m-0'>\r\n      <Col className='d-none d-lg-flex align-items-center p-5' lg='8' sm='12'>\r\n          <div className='w-100 d-lg-flex align-items-center justify-content-center px-5'>\r\n            <img className='img-fluid' src={source} alt='Login V2' />\r\n          </div>\r\n        </Col>\r\n        <Col className='d-flex align-items-center auth-bg px-2 p-lg-5' lg='4' sm='12'>\r\n          <Col className='px-xl-2 mx-auto' sm='8' md='6' lg='12'>\r\n            <CardText className='mb-2'>We will send you a OTP to verify user.</CardText>\r\n            <Form className='auth-login-form mt-2' onSubmit={handleSubmit(onSubmit)}>\r\n         {/* {count === 0 ?  <FormGroup>\r\n                  <Label className='form-label' for='login-email'>\r\n                   Mobile Number\r\n                  </Label>\r\n                  <Input\r\n                  autoFocus\r\n                  type='phone'\r\n                  value={phone}\r\n                  id='login_phone'\r\n                  name='login_phone'\r\n                  placeholder='Your Phone'\r\n                  onChange={e => setPhone(e.target.value)}\r\n                  className={classnames({ 'is-invalid': errors['login_phone'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                     validate: value => value !== '',\r\n                     pattern:{value:/^\\d{10}$/,\r\n                                message:\"please enter your 10 digit phone number\"}\r\n                               })}\r\n                />\r\n                </FormGroup> : \" \"}   */}\r\n                <FormGroup>\r\n                <div className='d-flex justify-content-between'>\r\n                  <Label className='form-label' for='login-password'>\r\n                    OTP\r\n                  </Label>\r\n                  {/* <Link to='/forgot-password'>\r\n                    <small>Forgot Password?</small>\r\n                  </Link> */}\r\n                </div>\r\n                <Input\r\n                  value={otp}\r\n                  id='login_otp'\r\n                  name='login_otp'\r\n                  maxLength={6}\r\n                  className='input-group-merge'\r\n                  placeholder=\"Enter Your OTP\"\r\n                  onChange={e => setOtp(e.target.value)}\r\n                  className={classnames({ 'is-invalid': errors['login_otp'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                          pattern:{value:/^\\d{6}$/,\r\n                                message:\"please enter your 6 digit otp\"},\r\n                                 validate: value => value !== '' })}\r\n                />\r\n                        {/* <OtpInput\r\n             value={otp}\r\n             onChange={otp => setOtp(otp)}\r\n             name='login_otp'\r\n             inputStyle={{\r\n               width:\"62px\",\r\n               hight:\"62px\"\r\n\r\n             }}\r\n             name=\"login_otp\"\r\n             className={classnames({ 'is-invalid': errors['login_otp'] })}\r\n             innerRef={register({ \r\n               required: true,\r\n                     pattern:{value:/^\\d{6}$/,\r\n                           message:\"please enter your 6 digit otp\"},\r\n                            validate: value => value !== '' })}\r\n          numInputs={6}\r\n          separator={<span>-</span>}\r\n        /> */}\r\n              </FormGroup>\r\n            \r\n              {count === 0 ? <div style={{display:\"flex\"}}>\r\n             <h5> Didn't receive the otp ?</h5><h4 onClick={resend} style={{color:\"red\"}}>Resend OTP</h4>\r\n             </div> : <Button.Ripple type='submit' color='primary' block>\r\n               Send OTP\r\n              </Button.Ripple>}\r\n            </Form>\r\n            <h5 className='text-right mt-2'>00:{count}</h5>\r\n            <p >\r\n              {/* <span className='mr-25'>New on our platform?</span> */}\r\n              {/* <Link to='/register'> */}\r\n              {/* <Link to='/forgot-password'>\r\n                <span>Forgot Password ?</span>\r\n              </Link> */}\r\n            \r\n            </p>\r\n\r\n          </Col>\r\n        </Col>\r\n\r\n      </Row>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(OtpOnLogin)"]},"metadata":{},"sourceType":"module"}