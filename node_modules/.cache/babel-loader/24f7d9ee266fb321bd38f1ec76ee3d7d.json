{"ast":null,"code":"import _defineProperty from \"D:/nodejs/star/erpfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"D:/nodejs/star/erpfrontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"D:\\\\nodejs\\\\star\\\\erpfrontend\\\\src\\\\views\\\\pages\\\\authentication\\\\Otp.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useState, useContext, Fragment, useEffect } from 'react';\nimport classnames from 'classnames';\nimport Avatar from '@components/avatar';\nimport { useSkin } from '@hooks/useSkin';\nimport useJwt from '@src/auth/jwt/useJwt';\nimport { useDispatch } from 'react-redux';\nimport { useForm } from 'react-hook-form';\nimport { toast, Slide } from 'react-toastify';\nimport { SendOtp } from '@store/actions/auth';\nimport { AbilityContext } from '@src/utility/context/Can';\nimport { Link, useHistory } from 'react-router-dom';\nimport InputPasswordToggle from '@components/input-password-toggle';\nimport { withRouter } from 'react-router';\nimport { getHomeRouteForLoggedInUser, isObjEmpty } from '@utils';\nimport { Facebook, Twitter, Mail, GitHub, HelpCircle, Coffee } from 'react-feather';\nimport { Alert, Row, Col, CardTitle, CardText, Form, Input, FormGroup, Label, CustomInput, Button, UncontrolledTooltip } from 'reactstrap';\nimport axios from 'axios';\nimport '@styles/base/pages/page-auth.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar ToastContent = function ToastContent(_ref) {\n  var name = _ref.name,\n      role = _ref.role;\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"toastify-header\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(Avatar, {\n          size: \"sm\",\n          color: \"success\",\n          icon: /*#__PURE__*/_jsxDEV(Coffee, {\n            size: 12\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 37,\n            columnNumber: 49\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 9\n        }, _this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"toast-title font-weight-bold\",\n          children: [\"Welcome, \", name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 9\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 7\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 5\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 3\n  }, _this);\n};\n\n_c = ToastContent;\n\nvar OtpCreator = function OtpCreator(props) {\n  _s();\n\n  var _jsxDEV2;\n\n  var _useSkin = useSkin(),\n      _useSkin2 = _slicedToArray(_useSkin, 2),\n      skin = _useSkin2[0],\n      setSkin = _useSkin2[1];\n\n  var ability = useContext(AbilityContext);\n  var dispatch = useDispatch();\n  var history = useHistory();\n\n  var _useState = useState(props && props.location && props.location.state && props.location.state.login_phone),\n      _useState2 = _slicedToArray(_useState, 2),\n      phone = _useState2[0],\n      setPhone = _useState2[1];\n\n  var _useState3 = useState(50),\n      _useState4 = _slicedToArray(_useState3, 2),\n      count = _useState4[0],\n      setCount = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      password = _useState6[0],\n      setOtp = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      existmobile = _useState8[0],\n      setExistMobile = _useState8[1];\n\n  console.log(props);\n\n  var _useForm = useForm(),\n      register = _useForm.register,\n      errors = _useForm.errors,\n      handleSubmit = _useForm.handleSubmit;\n\n  var illustration = skin === 'dark' ? 'login-v2-dark.svg' : 'login-v2.svg',\n      source = require(\"@src/assets/images/pages/\".concat(illustration)).default;\n\n  var intervalId; // console.log(props.location.state.login_phone)\n\n  var resend = function resend() {\n    clearInterval(intervalId);\n    setCount(30);\n    history.push('/otp');\n    axios.post(\"http://172.105.49.15:3030/api/user/check_mobile_number_exist\", {\n      mobile_number: props.location.state.mobile // password:data.password\n\n    }).then(function (r) {\n      console.log(r);\n      setExistMobile(r);\n\n      if (r.data !== null) {\n        axios.post(\"http://172.105.49.15:3030/api/user/send_otp\", {\n          mobile_number: props.location.state.mobile // password:data.password\n\n        }).then(function (r) {\n          console.log(r);\n        }); // props.history.push('/otp')\n        // alert(\"We will send you a OTP to verify user\")\n        // toast.success(\n        //   <ToastContent name={ 'We will send you a OTP to verify user'}  />,\n        //   { transition: Slide, hideProgressBar: true, autoClose: 2000 }\n        // )\n      } else {// alert(\"Mobile number not exist\")\n        }\n    });\n  }; // useEffect(() => {\n  // axios.post(`http://172.105.49.15:3030/api/user/check_mobile_number_exist`, {\n  //     mobile_number:phone\n  //     // password:data.password\n  // })\n  // .then(r => { \n  //   console.log(r)\n  //   setExistMobile(r)\n  //    if (r.data !== null) {\n  //     axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\n  //       mobile_number:phone\n  //       // password:data.password\n  //   })\n  //   .then(r => {\n  //     console.log(r)\n  //   })\n  //   props.history.push('/otp')\n  //   toast.success(\n  //     <ToastContent name={ 'We will send you a OTP to verify user'} role={ 'admin'} />,\n  //     { transition: Slide, hideProgressBar: true, autoClose: 2000 }\n  //   )\n  //   } else {\n  //     // alert(\"Mobile number not exist\")\n  //   }\n  //   })\n  // }, [phone])\n\n\n  useEffect(function () {\n    intervalId = setInterval(function () {\n      return setCount(function (counter) {\n        return counter - 1;\n      });\n    }, 1000);\n  }, [setCount]); // console.log(count, intervalId)\n\n  if (count === -1) {\n    // resend()\n    setCount(0);\n  }\n\n  var onSubmit = function onSubmit(data) {\n    dispatch(SendOtp(data, props)); // history.push('/forgot-password')\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth-wrapper auth-v2\",\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      className: \"auth-inner m-0\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        className: \"d-none d-lg-flex align-items-center p-5\",\n        lg: \"8\",\n        sm: \"12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-100 d-lg-flex align-items-center justify-content-center px-5\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"img-fluid\",\n            src: source,\n            alt: \"Login V2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 7\n      }, _this), /*#__PURE__*/_jsxDEV(Col, {\n        className: \"d-flex align-items-center auth-bg px-2 p-lg-5\",\n        lg: \"4\",\n        sm: \"12\",\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          className: \"px-xl-2 mx-auto\",\n          sm: \"8\",\n          md: \"6\",\n          lg: \"12\",\n          children: [/*#__PURE__*/_jsxDEV(CardText, {\n            className: \"mb-2\",\n            children: \"We will send you a OTP to verify user.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Form, {\n            className: \"auth-login-form mt-2\",\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between\",\n                children: /*#__PURE__*/_jsxDEV(Label, {\n                  className: \"form-label\",\n                  for: \"login-password\",\n                  children: \"OTP\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 19\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(Input, (_jsxDEV2 = {\n                value: password,\n                id: \"login_otp\",\n                name: \"login_otp\",\n                maxLength: 6,\n                className: \"input-group-merge\",\n                placeholder: \"Enter Your OTP\",\n                onChange: function onChange(e) {\n                  return setOtp(e.target.value);\n                }\n              }, _defineProperty(_jsxDEV2, \"className\", classnames({\n                'is-invalid': errors['login_otp']\n              })), _defineProperty(_jsxDEV2, \"innerRef\", register({\n                required: true,\n                pattern: {\n                  value: /^\\d{6}$/,\n                  message: \"please enter your 6 digit otp\"\n                }\n              })), _jsxDEV2), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 6\n            }, _this), count === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                children: \" Didn't receive the otp ?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 14\n              }, _this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                onClick: resend,\n                style: {\n                  color: \"red\"\n                },\n                children: \"Resend OTP\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 48\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 31\n            }, _this) : /*#__PURE__*/_jsxDEV(Button.Ripple, {\n              type: \"submit\",\n              color: \"primary\",\n              block: true,\n              children: \"Enter OTP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 23\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"text-right mt-2\",\n            children: [\"00:\", count]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(OtpCreator, \"J+s/cFV7jh6+lxOhWYaYBePr+/k=\", false, function () {\n  return [useSkin, useDispatch, useHistory, useForm];\n});\n\n_c2 = OtpCreator;\nexport default _c3 = withRouter(OtpCreator);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ToastContent\");\n$RefreshReg$(_c2, \"OtpCreator\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["D:/nodejs/star/erpfrontend/src/views/pages/authentication/Otp.js"],"names":["useState","useContext","Fragment","useEffect","classnames","Avatar","useSkin","useJwt","useDispatch","useForm","toast","Slide","SendOtp","AbilityContext","Link","useHistory","InputPasswordToggle","withRouter","getHomeRouteForLoggedInUser","isObjEmpty","Facebook","Twitter","Mail","GitHub","HelpCircle","Coffee","Alert","Row","Col","CardTitle","CardText","Form","Input","FormGroup","Label","CustomInput","Button","UncontrolledTooltip","axios","ToastContent","name","role","OtpCreator","props","skin","setSkin","ability","dispatch","history","location","state","login_phone","phone","setPhone","count","setCount","password","setOtp","existmobile","setExistMobile","console","log","register","errors","handleSubmit","illustration","source","require","default","intervalId","resend","clearInterval","push","post","mobile_number","mobile","then","r","data","setInterval","counter","onSubmit","e","target","value","required","pattern","message","display","color"],"mappings":"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","sourcesContent":["import { useState, useContext, Fragment, useEffect } from 'react'\r\nimport classnames from 'classnames'\r\nimport Avatar from '@components/avatar'\r\nimport { useSkin } from '@hooks/useSkin'\r\nimport useJwt from '@src/auth/jwt/useJwt'\r\nimport { useDispatch } from 'react-redux'\r\nimport { useForm } from 'react-hook-form'\r\nimport { toast, Slide } from 'react-toastify'\r\nimport { SendOtp } from '@store/actions/auth'\r\nimport { AbilityContext } from '@src/utility/context/Can'\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport InputPasswordToggle from '@components/input-password-toggle'\r\nimport { withRouter } from 'react-router'\r\nimport { getHomeRouteForLoggedInUser, isObjEmpty } from '@utils'\r\nimport { Facebook, Twitter, Mail, GitHub, HelpCircle, Coffee } from 'react-feather'\r\nimport {\r\n  Alert,\r\n  Row,\r\n  Col,\r\n  CardTitle,\r\n  CardText,\r\n  Form,\r\n  Input,\r\n  FormGroup,\r\n  Label,\r\n  CustomInput,\r\n  Button,\r\n  UncontrolledTooltip\r\n} from 'reactstrap'\r\nimport axios from 'axios'\r\nimport '@styles/base/pages/page-auth.scss'\r\n\r\nconst ToastContent = ({ name, role }) => (\r\n  <Fragment>\r\n    <div className='toastify-header'>\r\n      <div className='title-wrapper'>\r\n        <Avatar size='sm' color='success' icon={<Coffee size={12} />} />\r\n        <h6 className='toast-title font-weight-bold'>Welcome, {name}</h6>\r\n      </div>\r\n    </div>\r\n    {/* <div className='toastify-body'>\r\n      <span>You have successfully logged in as an {role}. Now you can start to explore. Enjoy!</span>\r\n    </div> */}\r\n  </Fragment>\r\n)\r\n\r\nconst OtpCreator = props => {\r\n  const [skin, setSkin] = useSkin()\r\n  const ability = useContext(AbilityContext)\r\n  const dispatch = useDispatch()\r\n  const history = useHistory()\r\n  const [phone, setPhone] = useState(props && props.location && props.location.state && props.location.state.login_phone)\r\n  const [count, setCount] = useState(50)\r\n  const [password, setOtp] = useState('')\r\n  const [existmobile, setExistMobile] = useState('')\r\nconsole.log(props)\r\n  const { register, errors, handleSubmit } = useForm()\r\n  const illustration = skin === 'dark' ? 'login-v2-dark.svg' : 'login-v2.svg',\r\n    source = require(`@src/assets/images/pages/${illustration}`).default\r\n    let intervalId\r\n\r\n// console.log(props.location.state.login_phone)\r\n    const resend = () => {\r\n      clearInterval(intervalId)\r\n      setCount(30)\r\n    history.push('/otp')\r\n    axios.post(`http://172.105.49.15:3030/api/user/check_mobile_number_exist`, {\r\n    mobile_number:props.location.state.mobile\r\n    // password:data.password\r\n})\r\n.then(r => { \r\n  console.log(r)\r\n  setExistMobile(r)\r\n   if (r.data !== null) {\r\n    axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\r\n      mobile_number:props.location.state.mobile\r\n      // password:data.password\r\n  })\r\n  .then(r => {\r\n    console.log(r)\r\n  })\r\n  // props.history.push('/otp')\r\n  // alert(\"We will send you a OTP to verify user\")\r\n  // toast.success(\r\n  //   <ToastContent name={ 'We will send you a OTP to verify user'}  />,\r\n  //   { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n  // )\r\n\r\n  } else {\r\n    // alert(\"Mobile number not exist\")\r\n  }\r\n  })\r\n    }\r\n  \r\n// useEffect(() => {\r\n\r\n// axios.post(`http://172.105.49.15:3030/api/user/check_mobile_number_exist`, {\r\n//     mobile_number:phone\r\n//     // password:data.password\r\n// })\r\n// .then(r => { \r\n//   console.log(r)\r\n//   setExistMobile(r)\r\n//    if (r.data !== null) {\r\n//     axios.post(`http://172.105.49.15:3030/api/user/send_otp`, {\r\n//       mobile_number:phone\r\n//       // password:data.password\r\n//   })\r\n//   .then(r => {\r\n//     console.log(r)\r\n//   })\r\n//   props.history.push('/otp')\r\n//   toast.success(\r\n//     <ToastContent name={ 'We will send you a OTP to verify user'} role={ 'admin'} />,\r\n//     { transition: Slide, hideProgressBar: true, autoClose: 2000 }\r\n//   )\r\n\r\n//   } else {\r\n//     // alert(\"Mobile number not exist\")\r\n//   }\r\n//   })\r\n// }, [phone])\r\nuseEffect(() => {\r\n  intervalId = setInterval(() => setCount(counter => counter - 1), 1000)\r\n}, [setCount])\r\n// console.log(count, intervalId)\r\nif (count === -1) {\r\n  // resend()\r\n  setCount(0)\r\n}\r\n  const onSubmit = data => {\r\n    dispatch(SendOtp(data, props))\r\n// history.push('/forgot-password')\r\n  }\r\n\r\n  return (\r\n    <div className='auth-wrapper auth-v2'>\r\n      <Row className='auth-inner m-0'>\r\n      <Col className='d-none d-lg-flex align-items-center p-5' lg='8' sm='12'>\r\n          <div className='w-100 d-lg-flex align-items-center justify-content-center px-5'>\r\n            <img className='img-fluid' src={source} alt='Login V2' />\r\n          </div>\r\n        </Col>\r\n        <Col className='d-flex align-items-center auth-bg px-2 p-lg-5' lg='4' sm='12'>\r\n          <Col className='px-xl-2 mx-auto' sm='8' md='6' lg='12'>\r\n            <CardText className='mb-2'>We will send you a OTP to verify user.</CardText>\r\n            <Form className='auth-login-form mt-2' onSubmit={handleSubmit(onSubmit)}>\r\n            {/* <FormGroup>\r\n                  <Label className='form-label' for='login-email'>\r\n                   Mobile Number\r\n                  </Label>\r\n                  <Input\r\n                  autoFocus\r\n                  type='phone'\r\n                  value={phone}\r\n                  id='login_phone'\r\n                  name='login_phone'\r\n                  placeholder='Your Phone'\r\n                  onChange={e => setPhone(e.target.value)}\r\n                  className={classnames({ 'is-invalid': errors['login_phone'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                     validate: value => value !== '',\r\n                     pattern:{value:/^\\d{10}$/,\r\n                                message:\"please enter your 10 digit phone number\"}\r\n                               })}\r\n                />\r\n                </FormGroup> */}\r\n     <FormGroup>\r\n                <div className='d-flex justify-content-between'>\r\n                  <Label className='form-label' for='login-password'>\r\n                    OTP\r\n                  </Label>\r\n                  {/* <Link to='/forgot-password'>\r\n                    <small>Forgot Password?</small>\r\n                  </Link> */}\r\n                </div>\r\n                <Input\r\n                  value={password}\r\n                  id='login_otp'\r\n                  name='login_otp'\r\n                  maxLength={6}\r\n                  className='input-group-merge'\r\n                  placeholder=\"Enter Your OTP\"\r\n                  onChange={e => setOtp(e.target.value)}\r\n                  className={classnames({ 'is-invalid': errors['login_otp'] })}\r\n                  innerRef={register({ \r\n                    required: true,\r\n                          pattern:{value:/^\\d{6}$/,\r\n                                message:\"please enter your 6 digit otp\"}})}\r\n                />\r\n              </FormGroup> \r\n              {/* <FormGroup>\r\n                <CustomInput type='checkbox' className='custom-control-Primary' id='remember-me' label='Remember Me' />\r\n              </FormGroup> */}\r\n            \r\n              {count === 0 ?  <div style={{display:\"flex\"}}>\r\n             <h5> Didn't receive the otp ?</h5><h4 onClick={resend} style={{color:\"red\"}}>Resend OTP</h4>\r\n             </div> : <Button.Ripple type='submit' color='primary' block>\r\n               Enter OTP\r\n              </Button.Ripple>}\r\n            </Form>\r\n            <h5 className='text-right mt-2'>00:{count}</h5>\r\n            <p >\r\n              {/* <span className='mr-25'>New on our platform?</span> */}\r\n              {/* <Link to='/register'> */}\r\n              {/* <Link to='/forgot-password'>\r\n                <span>Forgot Password ?</span>\r\n              </Link> */}\r\n            \r\n            </p>\r\n\r\n          </Col>\r\n        </Col>\r\n\r\n      </Row>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(OtpCreator)"]},"metadata":{},"sourceType":"module"}